# Road defects detection datasets

## Project organization

There should be two annotation Workspaces for manual and automatic annotation of potholes and guardrails.

### Guardrails annotation

This Workspace should contain the following tasks:

- Training batch 1 - The images in this task are used for manual annotation of data gathered from the internet of damaged and undamaged guardrails. This data is then used for training our model.
- Verification batch 1 - This is the same set of images to confirm that our newly trained model overfits the original training data. The polygons in this task are generated by running Automatic annotation using our newly trained model Guardrails damage detection v1.

### Potholes annotation

This Workspace should contain the following tasks:

- Training batch 1 - The images in this task are used for manual annotation of data gathered from a video of a road with or without potholes. This data is then used for training our model.
- Verification batch 1 - This is the same set of images to confirm that our newly trained model overfits the original training data. The polygons in this task are generated by running Automatic annotation using our newly trained model Potholes detection v1.

## Annotation and training process

General [annotation](https://docs.onepanel.ai/docs/reference/cvat/quickstart), [training](https://docs.onepanel.ai/docs/reference/cvat/built-in-models) and [automatic annotation](https://docs.onepanel.ai/docs/reference/cvat/automatic-annotation) processes are outlined in Onepanel’s documentation.

Both models for potholes and guardrails damage detection are trained using MaskRCNN Training Workflow in Onepanel using the hyperparameters described above.

Hyperparameters for guardrails damage detection training:

```
stage-1-epochs=8    #  Epochs for network heads
stage-2-epochs=17    #  Epochs for finetune layers
stage-3-epochs=33    #  Epochs for all layers
```

Hyperparameters for potholes detection training:

```
stage-1-epochs=2    #  Epochs for network heads
stage-2-epochs=4    #  Epochs for finetune layers
stage-3-epochs=6    #  Epochs for all layers
```

## Reproduction in other clusters

All the Workflows and Workspace Templates used in this project are available out of the box when Onepanel is deployed. To deploy Onepanel, refer to the quick start documentation.

The raw input data for both potholes and guardrails can be found in this repository under datasets. The annotation dumps (COCO format) can be found in the same repository under annotation-dumps.

Once Onepanel is deployed, the entire annotation and training process can be reproduced by following the steps described in “Annotation and training process” above.
